<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SENTINELA V12 - REFORMA TRIBUT√ÅRIA 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --neon-blue: #00f2ff; --neon-green: #00ff9d; }
        body { background: #02040a; color: #e6edf3; font-family: 'Space Grotesk', sans-serif; }
        
        .cyber-card { 
            background: rgba(13, 17, 23, 0.9); 
            backdrop-filter: blur(20px); 
            border: 1px solid #30363d;
            border-top: 4px solid var(--neon-blue);
        }

        .log-terminal {
            background: #000;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--neon-green);
            border: 1px solid #1a1a1a;
            height: 120px;
            overflow-y: auto;
            padding: 10px;
        }

        .input-v12 {
            background: #0d1117;
            border: 1px solid #30363d;
            color: var(--neon-blue);
            padding: 12px;
            border-radius: 8px;
            width: 100%;
        }

        @media print {
            .no-print { display: none !important; }
            #print-area { display: block !important; background: white !important; color: black !important; }
        }
        #print-area { display: none; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="no-print max-w-6xl mx-auto space-y-6">
        <header class="cyber-card p-6 rounded-2xl flex flex-col md:flex-row justify-between items-center border-b-4 border-blue-500">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-white rounded-lg rotate-3 shadow-neon">
                    <span class="text-black font-black text-xl">V12</span>
                </div>
                <div>
                    <h1 class="text-3xl font-black uppercase italic tracking-tighter">Sentinela <span class="text-cyan-400">V12</span></h1>
                    <p class="text-[9px] tracking-[0.4em] text-slate-500 font-bold uppercase">Fiscal Command - Reforma 2026</p>
                </div>
            </div>
            
            <div class="flex flex-col items-end gap-2">
                <div id="statusHardware" class="flex items-center gap-2 bg-red-500/10 px-4 py-1 rounded-full border border-red-500/20">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                    <span class="text-[10px] font-black text-red-500 uppercase">Hardware Serpro Offline</span>
                </div>
                <div class="text-[10px] text-slate-400 font-mono">NODE_ISR_V12_ACTIVE</div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <div class="lg:col-span-8 space-y-6">
                <div class="cyber-card p-8 rounded-3xl">
                    <h2 class="text-xs font-black text-cyan-500 uppercase tracking-widest mb-6 italic">‚óè Emiss√£o de Documento de Autoridade</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="col-span-2">
                            <input type="text" id="cliNome" placeholder="NOME OU RAZ√ÉO SOCIAL" class="input-v12">
                        </div>
                        <input type="text" id="cliDoc" placeholder="CPF / CNPJ" class="input-v12">
                        <input type="text" id="cliEnd" placeholder="ENDERE√áO COMPLETO" class="input-v12">
                        <div class="col-span-2">
                            <input type="text" id="prodDesc" placeholder="DESCRI√á√ÉO DO SERVI√áO / ATIVO" class="input-v12">
                        </div>
                        <div class="relative">
                            <span class="absolute left-3 top-3 text-slate-500 text-xs">R$</span>
                            <input type="number" id="prodValor" oninput="calcularImpostos()" class="input-v12 pl-10 text-xl font-bold" placeholder="VALOR BRUTO">
                        </div>
                    </div>
                </div>

                <div class="log-terminal rounded-xl shadow-inner" id="terminalLog">
                    [SYSTEM] Aguardando entrada de dados...<br>
                    [V12] Motor de Reforma Tribut√°ria 2026 carregado (IBS/CBS).<br>
                </div>
            </div>

            <div class="lg:col-span-4 space-y-4">
                <div class="cyber-card p-6 rounded-3xl bg-blue-500/5 border-t-4 border-blue-400">
                    <h3 class="text-center text-[10px] font-black uppercase mb-4 tracking-widest text-blue-400 italic">C√°lculo Tribut√°rio 2026</h3>
                    
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between border-b border-white/5 pb-2">
                            <span class="text-slate-400 text-xs">CBS (Federal):</span>
                            <span id="resCBS" class="font-bold text-white">R$ 0,00</span>
                        </div>
                        <div class="flex justify-between border-b border-white/5 pb-2">
                            <span class="text-slate-400 text-xs">IBS (Estadual/Mun.):</span>
                            <span id="resIBS" class="font-bold text-white">R$ 0,00</span>
                        </div>
                        <div class="flex justify-between border-b border-white/5 pb-2">
                            <span class="text-slate-400 text-xs">IS (Seletivo):</span>
                            <span id="resIS" class="font-bold text-orange-400 italic">Isento</span>
                        </div>
                        <div class="flex justify-between pt-2">
                            <span class="text-cyan-400 font-bold">VALOR L√çQUIDO:</span>
                            <span id="resLiquido" class="font-black text-cyan-400 text-lg">R$ 0,00</span>
                        </div>
                    </div>
                </div>

                <div class="space-y-3">
                    <button onclick="gerar('A4')" class="w-full bg-white text-black py-4 rounded-xl font-black uppercase text-xs hover:bg-cyan-400 transition-all shadow-lg">
                        üìÑ Assinar e Transmitir A4
                    </button>
                    <button onclick="gerar('TERMICA')" class="w-full border border-cyan-500 text-cyan-400 py-4 rounded-xl font-black uppercase text-xs hover:bg-cyan-500 hover:text-white transition-all">
                        üßæ Recibo T√©rmico 80mm
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="print-area"></div>

    <script>
        // Fun√ß√£o para simular o Log de sistema
        function addLog(msg) {
            const term = document.getElementById('terminalLog');
            term.innerHTML += `[${new Date().toLocaleTimeString()}] ${msg}<br>`;
            term.scrollTop = term.scrollHeight;
        }

        // C√ÅLCULO REFORMA TRIBUT√ÅRIA 2026 (Simula√ß√£o de al√≠quotas padr√£o)
        function calcularImpostos() {
            const valor = parseFloat(document.getElementById('prodValor').value) || 0;
            const cbs = valor * 0.088; // 8.8% Federal
            const ibs = valor * 0.177; // 17.7% Estadual/Mun
            const liquido = valor - (cbs + ibs);

            document.getElementById('resCBS').innerText = `R$ ${cbs.toFixed(2)}`;
            document.getElementById('resIBS').innerText = `R$ ${ibs.toFixed(2)}`;
            document.getElementById('resLiquido').innerText = `R$ ${liquido.toFixed(2)}`;
            
            if(valor > 0) addLog(`C√°lculo efetuado: IBS/CBS vinculados ao valor R$ ${valor.toFixed(2)}`);
        }

        // CONEX√ÉO COM ASSINADOR SERPRO (Hardware)
        function verificarHardware() {
            const status = document.getElementById('statusHardware');
            // Tentando conectar no servi√ßo local do Serpro
            const ws = new WebSocket('wss://127.0.0.1:6515');
            
            ws.onopen = () => {
                status.innerHTML = `<span class="w-2 h-2 bg-emerald-500 rounded-full"></span><span class="text-emerald-500">SERPRO CONECTADO</span>`;
                status.classList.replace('border-red-500/20', 'border-emerald-500/20');
                addLog("Assinador SERPRO detectado na porta 6515. Comunica√ß√£o estabelecida.");
            };
            ws.onerror = () => {
                addLog("Falha ao localizar Hardware de Assinatura. Execute o Assinador Serpro.");
            };
        }

        function gerar(tipo) {
            const val = {
                nome: document.getElementById('cliNome').value || "CLIENTE CONSUMIDOR",
                doc: document.getElementById('cliDoc').value || "000.000.000-00",
                end: document.getElementById('cliEnd').value || "N√ÉO INFORMADO",
                desc: document.getElementById('prodDesc').value || "SERVI√áO V12",
                valor: document.getElementById('prodValor').value || "0,00",
                data: new Date().toLocaleString(),
                nfe: Math.floor(Math.random() * 90000) + 10000
            };

            addLog(`Iniciando gera√ß√£o de documento ${tipo}... Assinando via Certificado Digital.`);

            let html = "";
            if(tipo === 'A4') {
                html = `
                <div style="padding: 40px; font-family: sans-serif; border: 10px solid #f0f0f0;">
                    <div style="display:flex; justify-content:space-between; border-bottom: 5px solid black; padding-bottom: 20px;">
                        <div>
                            <h1 style="margin:0; font-size:40px;">SENTINELA V12</h1>
                            <p><b>CRISTIAN AUTHORITY UNIT</b> | SISTEMA FISCAL ISR</p>
                        </div>
                        <div style="text-align:right;">
                            <p style="font-size:20px;"><b>DOC: ${val.nfe}</b></p>
                            <p>${val.data}</p>
                        </div>
                    </div>
                    <div style="margin-top:40px;">
                        <h3>DADOS DO DESTINAT√ÅRIO</h3>
                        <p><b>NOME:</b> ${val.nome}</p>
                        <p><b>DOCUMENTO:</b> ${val.doc}</p>
                        <p><b>ENDERE√áO:</b> ${val.end}</p>
                    </div>
                    <table style="width:100%; border-collapse:collapse; margin-top:30px;">
                        <tr style="background:black; color:white;">
                            <th style="padding:15px; text-align:left;">ESPECIFICA√á√ÉO DO ATIVO/SERVI√áO</th>
                            <th style="padding:15px; text-align:right;">SUBTOTAL</th>
                        </tr>
                        <tr>
                            <td style="padding:20px; border:1px solid black;">${val.desc}</td>
                            <td style="padding:20px; border:1px solid black; text-align:right;">R$ ${val.valor}</td>
                        </tr>
                    </table>
                    <div style="margin-top:20px; background:#f9f9f9; padding:20px; border:1px solid #ddd;">
                        <p><b>DETALHAMENTO TRIBUT√ÅRIO (REFORMA 2026):</b></p>
                        <p>CBS (FEDERAL): 8.8% | IBS (ESTADUAL/MUN): 17.7%</p>
                        <p style="font-size:18px;"><b>VALOR L√çQUIDO: R$ ${(val.valor * 0.735).toFixed(2)}</b></p>
                    </div>
                    <div style="margin-top:100px; text-align:center;">
                        <div style="border-top:2px solid black; display:inline-block; width:300px; padding-top:10px;">
                            ASSINADO DIGITALMENTE VIA SERPRO
                        </div>
                    </div>
                </div>`;
            } else {
                html = `
                <div style="width:80mm; font-family: 'Courier New', monospace; padding:5px;">
                    <center><b>SENTINELA V12</b><br>--- RECIBO FISCAL ---</center>
                    <p>DATA: ${val.data}</p>
                    <p>CLI: ${val.nome}</p>
                    <p>DOC: ${val.doc}</p>
                    <p>----------------------------</p>
                    <p>${val.desc}</p>
                    <p style="text-align:right;"><b>TOTAL: R$ ${val.valor}</b></p>
                    <p>----------------------------</p>
                    <center><p>AUTORIDADE: CRISTIAN</p></center>
                </div>`;
            }

            document.getElementById('print-area').innerHTML = html;
            window.print();
        }

        window.onload = verificarHardware;
    </script>
</body>
</html>
