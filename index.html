<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rob√¥ BR Fiscal - Cristian V2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print { .no-print { display: none; } #cupom-termico { display: block !important; } }
        .font-mono { font-family: 'Courier New', Courier, monospace; }
        .gradient-custom { background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <div class="no-print max-w-4xl mx-auto p-4 md:p-10">
        <header class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div class="text-center md:text-left">
                <h1 class="text-3xl font-black tracking-tighter text-black">ROB√î BR FISCAL üöÄ</h1>
                <p class="text-sm text-gray-500 font-bold uppercase tracking-widest">N√≠vel de Autoridade: Cristian</p>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-xl border border-gray-100 w-full md:w-auto">
                <label class="text-[10px] text-gray-400 block uppercase font-bold">Digitar CNPJ para Varredura</label>
                <input type="text" id="cnpj-input" placeholder="00.000.000/0000-00" 
                       class="text-xl font-mono font-bold outline-none text-blue-600 w-full">
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100">
                <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <span class="w-3 h-3 bg-green-500 rounded-full animate-ping"></span> Status do Governo
                </h2>
                <div id="status-container" class="space-y-3">
                    <p class="text-gray-400 text-sm">Aguardando comando...</p>
                </div>
                <button onclick="dispararRobo()" id="btn-acao" class="w-full mt-6 bg-black text-white py-4 rounded-2xl font-bold hover:bg-gray-800 transition-all shadow-lg">
                    INICIAR VARREDURA FISCAL
                </button>
            </div>

            <div class="bg-gray-900 p-8 rounded-3xl shadow-2xl text-white">
                <h2 class="text-lg font-bold mb-4">A√ß√µes de Emiss√£o</h2>
                <div class="space-y-4">
                    <button onclick="imprimirTermica()" class="w-full bg-blue-600 py-3 rounded-xl font-bold hover:bg-blue-500 flex items-center justify-center gap-2">
                        <span>üñ®Ô∏è</span> Imprimir Nota T√©rmica
                    </button>
                    <button class="w-full bg-gray-800 py-3 rounded-xl font-bold border border-gray-700 opacity-50 cursor-not-allowed">
                        Gerar Guia DAS (Simples)
                    </button>
                </div>
                <p class="mt-6 text-[10px] text-gray-500 text-center uppercase tracking-widest">Integrado com InfinitePay API</p>
            </div>
        </div>
    </div>

    <div id="cupom-termico" class="hidden font-mono text-[12px] p-4 w-[80mm] bg-white text-black">
        <center>
            <p class="font-bold">ROB√î BR FISCAL</p>
            <p>CONFORMIDADE GOVERNAMENTAL</p>
            <p>--------------------------------</p>
        </center>
        <p>CNPJ: <span id="print-cnpj"></span></p>
        <p>DATA: <span id="print-data"></span></p>
        <p>ORIGEM: API INFINITEPAY</p>
        <p>--------------------------------</p>
        <p class="font-bold">STATUS FISCAL: REGULAR</p>
        <p>D√çVIDA ATIVA: NADA CONSTA</p>
        <p>RECEITA FEDERAL: OK</p>
        <p>--------------------------------</p>
        <p class="text-center font-bold text-lg">NF-E EMITIDA COM SUCESSO</p>
        <p class="text-[10px] text-center">Autentica√ß√£o: AWS-LAMBDA-CRISTIAN-2026</p>
    </div>

    <script>
        async function dispararRobo() {
            const cnpj = document.getElementById('cnpj-input').value;
            const btn = document.getElementById('btn-acao');
            const container = document.getElementById('status-container');

            if(!cnpj) { alert("Por favor, digite o CNPJ."); return; }

            btn.innerText = "PROCESSANDO NA AWS...";
            btn.disabled = true;

            try {
                const response = await fetch('https://x7rrkmlue3fbvk5j5awpfzy3he0jwoeq.lambda-url.sa-east-1.on.aws/', {
                    method: 'POST',
                    body: JSON.stringify({ cnpj: cnpj }),
                    headers: { 'Content-Type': 'application/json' }
                });

                const data = await response.json();

                container.innerHTML = `
                    <div class="p-3 bg-green-50 rounded-xl border border-green-100">
                        <p class="text-xs text-green-600 font-bold uppercase">Receita Federal</p>
                        <p class="font-bold text-gray-800">${data.diagnostico.receita_federal}</p>
                    </div>
                    <div class="p-3 bg-blue-50 rounded-xl border border-blue-100">
                        <p class="text-xs text-blue-600 font-bold uppercase">D√≠vida Ativa</p>
                        <p class="font-bold text-gray-800">${data.diagnostico.pgfn_divida}</p>
                    </div>
                `;
                
                document.getElementById('print-cnpj').innerText = cnpj;
                document.getElementById('print-data').innerText = new Date().toLocaleString();
                alert("Rob√¥ BR Fiscal: Varredura conclu√≠da com sucesso!");

            } catch (error) {
                alert("Erro ao conectar com o rob√¥ AWS. Verifique o link.");
            } finally {
                btn.innerText = "INICIAR VARREDURA FISCAL";
                btn.disabled = false;
            }
        }

        function imprimirTermica() {
            window.print();
        }
    </script>
</body>
</html>
