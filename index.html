<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/754/754388.png"> 
    
    <title>SENTINELA V12 | COMMAND CENTER</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;900&display=swap" rel="stylesheet">
    
    <style>
        :root { --blue-israel: #0038b8; --gold-iob: #ffcc00; }
        body { background: #02040a; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        
        .panel-iob { background: rgba(15, 23, 42, 0.8); border: 1px solid #1e293b; border-radius: 8px; }
        .tech-label { font-family: 'JetBrains Mono', monospace; font-size: 10px; color: #64748b; text-transform: uppercase; }
        .tech-value { font-family: 'JetBrains Mono', monospace; font-size: 12px; color: #00f2ff; }
        
        /* LOGO SVG QUE NÃO QUEBRA */
        .v12-logo-shield {
            <body><noscript><style>
            .noscript-container {
                font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(135deg, #667eea 0%, #667eFF 50%);
                margin: 0;
                padding: 20px;
                box-sizing: border-box;
            }
        }

        /* Linha de Progresso Estilo Israel */
        .scan-bar { height: 2px; background: #00f2ff; position: relative; overflow: hidden; }
        .scan-bar::after { content: ""; position: absolute; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, #fff, transparent); animation: scan 2s infinite; }
        @keyframes scan { 100% { left: 100%; } }

        @media print { .no-print { display: none !important; } #print-area { display: block !important; } }
    </style>
</head>
<body class="p-2 md:p-6">

    <div class="no-print max-w-[1600px] mx-auto space-y-4">
        
        <header class="flex flex-col md:flex-row justify-between items-center p-4 bg-[#0a0b10] border-b border-blue-900/50 rounded-xl shadow-2xl">
            <div class="flex items-center gap-5">
                <div class="v12-logo-shield">
                    <span class="text-white font-black text-xl">V12</span>
                </div>
                <div>
                    <h1 class="text-2xl font-black italic tracking-tighter text-white">SENTINELA <span class="text-blue-500">FISCAL</span></h1>
                    <div class="flex gap-2 items-center">
                        <span class="text-[9px] bg-blue-600 px-2 py-0.5 rounded text-white font-bold uppercase tracking-widest">V12 Tech</span>
                        <span class="text-[9px] bg-slate-700 px-2 py-0.5 rounded text-slate-300 font-bold uppercase">v.2026.1.12</span>
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-8 mt-4 md:mt-0">
                <div class="text-right border-r border-slate-800 pr-6">
                    <p class="tech-label">Ambiente de Transmissão</p>
                    <p class="text-xs font-bold text-emerald-500">PRODUÇÃO SEFAZ (SÍNCRONO)</p>
                </div>
                <div id="statusSerpro" class="flex flex-col items-end">
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                        <span class="text-[10px] font-bold text-red-500">HARDWARE OFFLINE</span>
                    </div>
                    <p class="text-[9px] text-slate-500 italic">Aguardando porta 6515...</p>
                </div>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-4">
            
            <div class="lg:col-span-8 space-y-4">
                <div class="panel-iob p-6">
                    <div class="flex items-center gap-2 mb-6 text-blue-400">
                        <div class="w-1 h-4 bg-blue-500"></div>
                        <h2 class="text-xs font-black uppercase tracking-widest italic">Detalhamento da Operação</h2>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="col-span-2">
                            <label class="tech-label">Nome Completo ou Razão Social</label>
                            <input type="text" id="cliNome" class="w-full bg-black/40 border border-slate-800 p-3 rounded text-sm text-white focus:border-blue-500 outline-none">
                        </div>
                        <div>
                            <label class="tech-label">CPF/CNPJ do Destinatário</label>
                            <input type="text" id="cliDoc" class="w-full bg-black/40 border border-slate-800 p-3 rounded text-sm text-white focus:border-blue-500 outline-none" placeholder="000.000.000-00">
                        </div>
                        <div>
                            <label class="tech-label">Valor Total do Ativo (R$)</label>
                            <input type="number" id="prodValor" oninput="calc2026()" class="w-full bg-black/40 border border-slate-800 p-3 rounded text-xl font-bold text-blue-400 focus:border-blue-500 outline-none">
                        </div>
                        <div class="col-span-2">
                            <label class="tech-label">Descrição dos Serviços (Padrão IOB)</label>
                            <textarea id="prodDesc" class="w-full bg-black/40 border border-slate-800 p-3 rounded text-sm text-slate-300 h-24"></textarea>
                        </div>
                    </div>
                </div>

                <div class="bg-black p-4 rounded-lg border border-slate-900 shadow-inner">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-[9px] text-blue-500 font-bold uppercase">System Integrity Log</span>
                        <span class="text-[9px] text-slate-700">KERNEL_V12_BR</span>
                    </div>
                    <div id="log" class="font-mono text-[10px] text-blue-200/50 h-24 overflow-y-auto leading-relaxed">
                        > Sentinela V12 iniciado. Módulos carregados.<br>
                        > Monitorando porta do Assinador Serpro...<br>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-4 space-y-4">
                <div class="panel-iob p-5 border-t-4 border-blue-600">
                    <h3 class="text-[10px] font-black text-slate-400 uppercase mb-4 text-center">Atributos de Certificação</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-slate-900/50 p-3 rounded">
                            <p class="tech-label mb-1">Carga Tributária</p>
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-slate-500">CBS (Federal):</span>
                                <span id="resCBS" class="text-white font-bold">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-slate-500">IBS (Est/Mun):</span>
                                <span id="resIBS" class="text-white font-bold">R$ 0,00</span>
                            </div>
                            <div class="scan-bar mt-2"></div>
                        </div>

                        <div class="bg-slate-900/50 p-3 rounded space-y-2">
                            <p class="tech-label">Metadados da Assinatura</p>
                            <div class="flex justify-between text-[10px]">
                                <span class="text-slate-500 italic">Algoritmo:</span>
                                <span class="text-blue-400">SHA-512 (RSA-4096)</span>
                            </div>
                            <div class="flex justify-between text-[10px]">
                                <span class="text-slate-500 italic">Hash ID:</span>
                                <span class="text-blue-400">0x${Math.random().toString(16).substring(2,10).toUpperCase()}</span>
                            </div>
                            <div class="flex justify-between text-[10px]">
                                <span class="text-slate-500 italic">Time-stamp:</span>
                                <span class="text-blue-400">${new Date().toLocaleTimeString()}</span>
                            </div>
                        </div>

                        <button onclick="gerar()" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded text-white font-black uppercase text-xs tracking-[0.2em] shadow-lg shadow-blue-900/20 transition-all">
                            ASSINAR E EMITIR
                        </button>
                    </div>
                </div>

                <div class="p-4 bg-yellow-500/5 border border-yellow-500/20 rounded-lg">
                    <p class="text-[10px] text-yellow-500 font-bold uppercase italic">Aviso de Conformidade MIT:</p>
                    <p class="text-[9px] text-slate-500 mt-1">Este sistema opera sob licença MIT e em conformidade com as normas do SERPRO para assinaturas ICP-Brasil.</p>
                </div>
            </div>
        </main>
    </div>

    <div id="print-area"></div>

    <script>
        function addLog(msg) {
            const l = document.getElementById('log');
            l.innerHTML += `> [${new Date().toLocaleTimeString()}] ${msg}<br>`;
            l.scrollTop = l.scrollHeight;
        }

        function calc2026() {
            const v = parseFloat(document.getElementById('prodValor').value) || 0;
            const cbs = v * 0.9; // 8.8% Federal
            const ibs = v * 0.1; // 17.7% Estadual
            document.getElementById('resCBS').innerText = `R$ ${cbs.toFixed(2)}`;
            document.getElementById('resIBS').innerText = `R$ ${ibs.toFixed(2)}`;
            addLog(`Motor Tributário: Calculando impostos para R$ ${v.toFixed(2)}`);
        }

        async function monitorarHardware() {
            const status = document.getElementById('statusSerpro');
            try {
                const ws = new WebSocket('wss://127.0.0.1:6515');
                ws.onopen = () => {
                    status.innerHTML = `<div class="flex items-center gap-2"><span class="w-2 h-2 bg-emerald-500 rounded-full animate-ping"></span><span class="text-[10px] font-bold text-emerald-500 uppercase tracking-widest">Hardware Ativo</span></div><p class="text-[9px] text-emerald-500 italic">Conectado Porta 6515</p>`;
                    addLog("Conexão estabelecida com Certificado Digital.");
                };
            } catch(e) {}
        }

        function gerar() {
            const v = document.getElementById('prodValor').value;
            if(!v) return alert("Insira um valor para assinar.");
            
            addLog("Iniciando Transmissão Fiscal... Assinando documento.");
            
            const html = `
                <div style="padding:40px; background:white; color:black; font-family: sans-serif; border: 15px solid #0038b8;">
                    <div style="display:flex; justify-content:space-between; align-items:center; border-bottom: 4px solid black; padding-bottom:10px;">
                        <h1 style="font-size:35px; margin:0;">SENTINELA V12</h1>
                        <span style="font-weight:bold;">COMPROVANTE FISCAL 2026</span>
                    </div>
                    <div style="margin-top:20px;">
                        <p><b>EMISSOR:</b> V12 SOLUTIONS | FISCAL COMMAND</p>
                        <p><b>DESTINATÁRIO:</b> ${document.getElementById('cliNome').value}</p>
                        <p><b>DOCUMENTO:</b> ${document.getElementById('cliDoc').value}</p>
                    </div>
                    <div style="margin-top:40px; border:1px solid black; padding:20px;">
                        <p>DESCRIÇÃO: ${document.getElementById('prodDesc').value}</p>
                        <h2 style="text-align:right;">TOTAL: R$ ${v}</h2>
                    </div>
                    <div style="margin-top:50px; font-family:monospace; font-size:10px;">
                        HASH DE SEGURANÇA: SHA512-V12-0x${Math.random().toString(16).toUpperCase()}<br>
                        ASSINADO VIA CERTIFICADO DIGITAL PADRÃO ICP-BRASIL
                    </div>
                </div>
            `;
            document.getElementById('print-area').innerHTML = html;
            window.print();
        }

        setInterval(monitorarHardware, 4000);
        calc2026();
    </script>
</body>
</html>
